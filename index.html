<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <title>Contact Widget Page</title>
    <style>
      /* Optional: Keep body centered if you want to test the blank state */
      body {
        background-color: #f5f5f7;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }
      
      /* Optional: A message to confirm the page is working if the widget takes a moment to load */
      h1 {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        color: #555555;
        font-size: 24px;
      }
    </style>
  </head>
  <body>
    <h1>Redirecting to Support...</h1>
    
    <script>
      window.fwSettings={
        'widget_id':205000000615
      };
      !function(){if("function"!=typeof window.FreshworksWidget){var n=function(){n.q.push(arguments)};n.q=[],window.FreshworksWidget=n}}() 
    </script>
    <script type='text/javascript' src='https://euc-widget.freshworks.com/widgets/205000000615.js' async defer></script>

    <script>
      (function(){
        const hideHeading = () => {
          const h = document.querySelector('h1');
          if (h) h.style.display = 'none';
        };

        const selectors = [
          'iframe[src*="freshworks"]',
          'iframe[src*="euc-widget"]',
          'div[id^="fw-"]',
          'div[id*="freshworks"]',
          'div[class*="freshworks"]',
          'div[class*="fw-"]',
          '.freshworks-messenger',
          '.fw-widget',
          '[id^="fw-embed"]'
        ];

        const findWidgetElement = () => {
          for (let sel of selectors) {
            const el = document.querySelector(sel);
            if (el) return el;
          }
          return null;
        };

        const originalStyles = new WeakMap();

        const createOverlay = () => {
          let ov = document.getElementById('fw-center-overlay');
          if (ov) return ov;
          ov = document.createElement('div');
          ov.id = 'fw-center-overlay';
          Object.assign(ov.style, {
            position: 'fixed',
            inset: '0',
            background: 'rgba(0,0,0,0.45)',
            zIndex: '999998',
            transition: 'opacity 200ms ease',
            opacity: '0'
          });
          document.body.appendChild(ov);
          // fade in
          requestAnimationFrame(() => ov.style.opacity = '1');
          return ov;
        };

        const restoreElement = (el) => {
          if (!el) return;
          const orig = originalStyles.get(el) || {};
          for (let k in orig) el.style[k] = orig[k];
          originalStyles.delete(el);
        };

        const centerAndZoom = (el, scale = 1.2, duration = 350) => {
          if (!el) return false;
          try {
            // Save original inline styles so we can restore
            if (!originalStyles.has(el)) {
              const snapshot = {};
              ['position','left','top','bottom','right','transform','transformOrigin','transition','zIndex','width','height','maxWidth','maxHeight','boxShadow'].forEach(k => snapshot[k] = el.style[k] || '');
              originalStyles.set(el, snapshot);
            }

            // Make parent overflow visible to avoid clipping
            let p = el.parentElement;
            while (p && p !== document.body) {
              if (getComputedStyle(p).overflow === 'hidden') p.style.overflow = 'visible';
              p = p.parentElement;
            }

            const isIframe = el.tagName && el.tagName.toLowerCase() === 'iframe';

            // Apply centered fixed positioning
            Object.assign(el.style, {
              position: 'fixed',
              left: '50%',
              top: '50%',
              transformOrigin: 'center center',
              transition: `transform ${duration}ms ease, box-shadow ${duration}ms ease`,
              zIndex: '999999'
            });

            // Constrain size for nicer centered display
            if (!el.style.width) el.style.width = isIframe ? '420px' : 'min(420px, 90vw)';
            if (!el.style.maxHeight) el.style.maxHeight = '90vh';
            if (!el.style.height && isIframe) el.style.height = '600px';

            // Add subtle shadow
            el.style.boxShadow = '0 20px 40px rgba(0,0,0,0.25)';

            // Use translate + scale to center and zoom
            el.style.transform = `translate(-50%, -50%) scale(${scale})`;

            return true;
          } catch (e) {
            return false;
          }
        };

        const observeAndZoom = (scale = 1.2, duration = 350, timeout = 7000) => {
          const el = findWidgetElement();
          if (el && centerAndZoom(el, scale, duration)) {
            const ov = createOverlay();
            const close = () => {
              if (typeof FreshworksWidget === 'function') try { FreshworksWidget('close'); } catch(e){}
              restoreElement(el);
              if (ov && ov.parentElement) ov.parentElement.removeChild(ov);
              document.removeEventListener('keydown', onKey);
            };

            const onKey = (ev) => { if (ev.key === 'Escape') close(); };
            ov.addEventListener('click', close, { once: true });
            document.addEventListener('keydown', onKey);
            return;
          }

          const obs = new MutationObserver(() => {
            const found = findWidgetElement();
            if (found) {
              centerAndZoom(found, scale, duration);
              const ov = createOverlay();
              const close = () => {
                if (typeof FreshworksWidget === 'function') try { FreshworksWidget('close'); } catch(e){}
                restoreElement(found);
                if (ov && ov.parentElement) ov.parentElement.removeChild(ov);
                document.removeEventListener('keydown', onKey);
              };
              const onKey = (ev) => { if (ev.key === 'Escape') close(); };
              ov.addEventListener('click', close, { once: true });
              document.addEventListener('keydown', onKey);
              obs.disconnect();
            }
          });

          obs.observe(document.body, { childList: true, subtree: true });
          setTimeout(() => obs.disconnect(), timeout);
        };

        const openWidgetSafely = () => {
          try {
            if (typeof FreshworksWidget === 'function') {
              FreshworksWidget('open');
            }
          } catch (e) {}
        };

        const setup = () => {
          hideHeading();

          // If FreshworksWidget is available, register listener; otherwise poll for it
          if (typeof FreshworksWidget === 'function') {
            try {
              FreshworksWidget('on', 'widget:loaded', function() {
                openWidgetSafely();
                observeAndZoom();
              });
            } catch (e) {
              openWidgetSafely();
              observeAndZoom();
            }
          } else {
            let waited = 0;
            const iv = setInterval(() => {
              if (typeof FreshworksWidget === 'function') {
                clearInterval(iv);
                try {
                  FreshworksWidget('on', 'widget:loaded', function() {
                    openWidgetSafely();
                    observeAndZoom();
                  });
                } catch (e) {
                  openWidgetSafely();
                  observeAndZoom();
                }
              }
              waited += 250;
              if (waited > 7000) {
                clearInterval(iv);
                // Fallback attempts
                openWidgetSafely();
                observeAndZoom();
              }
            }, 250);
          }

          // Extra fallback opens in case the event isn't fired
          [300, 700, 1500, 3000].forEach(t => setTimeout(openWidgetSafely, t));
        };

        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          setTimeout(setup, 50);
        } else {
          document.addEventListener('DOMContentLoaded', setup);
        }
      })();
    </script>

  </body>
</html>